<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="欧阳松" />

  
  
  
    
  
  <meta name="description" content="临床上经常使用WB验证蛋白表达水平,使用ImageJ算出个泳道的灰度值以后,需要做归一化和均一化处理,步骤如下: 首先计算目的蛋白/内参蛋白得到相对比,(有的人直接拿这个来统计,当然也可以,但是对照组就不是1) 拿各个相对比再除以各组的对照组组的相对比,这样对照组就都是1了   这个功能可以很容易使用Excel or WPS实现,当然也可以直接进行T检验,但是发现如果所有值是1的话,是无法在excel上使用t检验函数的,当然最常见的是SPSS,最常用的作图工具是Graphpad Prism或Origin,不过定制性最高的却是R  比如有这样一个WB表格数据   sample A B C Actin    NC1 128061 362791 73876 595320  OE1 444296 685776 205065 595894  DR1 760531 1008761 336254 596468  NC2 206016 267960 126144 553840  OE2 454608 624546 251256 545392  DR2 703200 981132 376368 536944  NC3 215730 236808 118008 560008  OE3 441000 639600 255750 560505  DR3 666270 1042392 393492 561002     从excel里面复制以后,可以从excel直接粘贴数据 (Mac系统代码) wb &lt;- read." />

  
  <link rel="alternate" hreflang="en-us" href="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/" />

  









  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.f0cf03b20998d63e314819fa4a90c13f.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@swcyo" />
    <meta property="twitter:creator" content="@swcyo" />
  
  <meta property="og:site_name" content="Swcyo" />
  <meta property="og:url" content="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/" />
  <meta property="og:title" content="使用R语言统计多蛋白多组的WB数据 | Swcyo" />
  <meta property="og:description" content="临床上经常使用WB验证蛋白表达水平,使用ImageJ算出个泳道的灰度值以后,需要做归一化和均一化处理,步骤如下: 首先计算目的蛋白/内参蛋白得到相对比,(有的人直接拿这个来统计,当然也可以,但是对照组就不是1) 拿各个相对比再除以各组的对照组组的相对比,这样对照组就都是1了   这个功能可以很容易使用Excel or WPS实现,当然也可以直接进行T检验,但是发现如果所有值是1的话,是无法在excel上使用t检验函数的,当然最常见的是SPSS,最常用的作图工具是Graphpad Prism或Origin,不过定制性最高的却是R  比如有这样一个WB表格数据   sample A B C Actin    NC1 128061 362791 73876 595320  OE1 444296 685776 205065 595894  DR1 760531 1008761 336254 596468  NC2 206016 267960 126144 553840  OE2 454608 624546 251256 545392  DR2 703200 981132 376368 536944  NC3 215730 236808 118008 560008  OE3 441000 639600 255750 560505  DR3 666270 1042392 393492 561002     从excel里面复制以后,可以从excel直接粘贴数据 (Mac系统代码) wb &lt;- read." /><meta property="og:image" content="https://swcyo.netlify.app/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://swcyo.netlify.app/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-08-11T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-08-11T23:13:21&#43;08:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/"
  },
  "headline": "使用R语言统计多蛋白多组的WB数据",
  
  "datePublished": "2021-08-11T00:00:00Z",
  "dateModified": "2021-08-11T23:13:21+08:00",
  
  "author": {
    "@type": "Person",
    "name": "欧阳松"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Swcyo",
    "logo": {
      "@type": "ImageObject",
      "url": "https://swcyo.netlify.app/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "临床上经常使用WB验证蛋白表达水平,使用ImageJ算出个泳道的灰度值以后,需要做归一化和均一化处理,步骤如下: 首先计算目的蛋白/内参蛋白得到相对比,(有的人直接拿这个来统计,当然也可以,但是对照组就不是1) 拿各个相对比再除以各组的对照组组的相对比,这样对照组就都是1了   这个功能可以很容易使用Excel or WPS实现,当然也可以直接进行T检验,但是发现如果所有值是1的话,是无法在excel上使用t检验函数的,当然最常见的是SPSS,最常用的作图工具是Graphpad Prism或Origin,不过定制性最高的却是R  比如有这样一个WB表格数据   sample A B C Actin    NC1 128061 362791 73876 595320  OE1 444296 685776 205065 595894  DR1 760531 1008761 336254 596468  NC2 206016 267960 126144 553840  OE2 454608 624546 251256 545392  DR2 703200 981132 376368 536944  NC3 215730 236808 118008 560008  OE3 441000 639600 255750 560505  DR3 666270 1042392 393492 561002     从excel里面复制以后,可以从excel直接粘贴数据 (Mac系统代码) wb \u0026lt;- read."
}
</script>

  

  

  

  





  <title>使用R语言统计多蛋白多组的WB数据 | Swcyo</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="23921ff8040e6986fd730663c6f6ed6e" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.8988fb2a4bba758785868cfcb5244555.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Swcyo</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Swcyo</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post"><span>Blogs</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/project"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/event"><span>Events</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/publication"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>Teams</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>使用R语言统计多蛋白多组的WB数据</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Aug 11, 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    2 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/%E6%95%99%E7%A8%8B/">教程</a>, <a href="/category/r/">R</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      


<div id="临床上经常使用wb验证蛋白表达水平使用imagej算出个泳道的灰度值以后需要做归一化和均一化处理步骤如下" class="section level4">
<h4>临床上经常使用<code>WB</code>验证蛋白表达水平,使用<code>ImageJ</code>算出个泳道的灰度值以后,需要做归一化和均一化处理,步骤如下:</h4>
<ol style="list-style-type: decimal">
<li>首先计算目的蛋白/内参蛋白得到相对比,(有的人直接拿这个来统计,当然也可以,但是对照组就不是1)</li>
<li>拿各个相对比再除以各组的对照组组的相对比,这样对照组就都是1了</li>
</ol>
</div>
<div id="这个功能可以很容易使用excel-or-wps实现当然也可以直接进行t检验但是发现如果所有值是1的话是无法在excel上使用t检验函数的当然最常见的是spss最常用的作图工具是graphpad-prism或origin不过定制性最高的却是r" class="section level4">
<h4>这个功能可以很容易使用<code>Excel</code> or <code>WPS</code>实现,当然也可以直接进行T检验,但是发现如果所有值是1的话,是无法在<code>excel</code>上使用t检验函数的,当然最常见的是SPSS,最常用的作图工具是Graphpad Prism或Origin,不过定制性最高的却是<code>R</code></h4>
</div>
<div id="比如有这样一个wb表格数据" class="section level4">
<h4>比如有这样一个WB表格数据</h4>
<table>
<thead>
<tr class="header">
<th>sample</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>Actin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NC1</td>
<td>128061</td>
<td>362791</td>
<td>73876</td>
<td>595320</td>
</tr>
<tr class="even">
<td>OE1</td>
<td>444296</td>
<td>685776</td>
<td>205065</td>
<td>595894</td>
</tr>
<tr class="odd">
<td>DR1</td>
<td>760531</td>
<td>1008761</td>
<td>336254</td>
<td>596468</td>
</tr>
<tr class="even">
<td>NC2</td>
<td>206016</td>
<td>267960</td>
<td>126144</td>
<td>553840</td>
</tr>
<tr class="odd">
<td>OE2</td>
<td>454608</td>
<td>624546</td>
<td>251256</td>
<td>545392</td>
</tr>
<tr class="even">
<td>DR2</td>
<td>703200</td>
<td>981132</td>
<td>376368</td>
<td>536944</td>
</tr>
<tr class="odd">
<td>NC3</td>
<td>215730</td>
<td>236808</td>
<td>118008</td>
<td>560008</td>
</tr>
<tr class="even">
<td>OE3</td>
<td>441000</td>
<td>639600</td>
<td>255750</td>
<td>560505</td>
</tr>
<tr class="odd">
<td>DR3</td>
<td>666270</td>
<td>1042392</td>
<td>393492</td>
<td>561002</td>
</tr>
</tbody>
</table>
</div>
<div id="从excel里面复制以后可以从excel直接粘贴数据-mac系统代码" class="section level4">
<h4>从excel里面复制以后,可以从excel直接粘贴数据 (Mac系统代码)</h4>
<pre class="r"><code>wb &lt;- read.table(pipe(&quot;pbpaste&quot;), # 读取剪切板中的数据
                      sep=&quot;\t&quot;, # 指定分隔符
                      header = TRUE) </code></pre>
<p>如果是windows系统,那么代码就是:</p>
<pre class="r"><code>### wb &lt;- read.table(file = &quot;clipboard&quot;, sep = &quot;\t&quot;, header=TRUE) # </code></pre>
</div>
<div id="接着我们开始进行计算" class="section level4">
<h4>接着我们开始进行计算</h4>
</div>
<div id="首先是用目的蛋白内参蛋白actin我定义为x_r" class="section level4">
<h4>1. 首先是用目的蛋白/内参蛋白(actin),我定义为<code>x_r</code></h4>
<pre class="r"><code>wb$A_r&lt;-wb$A/wb$Actin
wb$B_r&lt;-wb$B/wb$Actin
wb$C_r&lt;-wb$C/wb$Actin</code></pre>
</div>
<div id="用x_r除以nc组的相对比我将他定义为x_n.由于没有excel的e2这种实现固定的办法因此我想办法曲折了一下我的思路是先新增一列a_n然后前3行除以a_r的第一行中间三行除以a_r的第四行后三行除以a_r的第七行然后居然成功了后面同法计算b和c蛋白的归一化值." class="section level4">
<h4>2. 用x_r除以NC组的相对比,我将他定义为’x_n’.由于没有<code>excel</code>的<code>$E$2</code>这种实现固定的办法,因此我想办法曲折了一下,我的思路是先新增一列<code>A_n</code>,然后前3行除以A_r的第一行,中间三行除以A_r的第四行,后三行除以A_r的第七行,然后居然成功了,后面同法计算B和C蛋白的归一化值.</h4>
<pre class="r"><code>wb$A_n[1:3]=wb$A_r[1:3]/wb$A_r[1]
wb$A_n[4:6]=wb$A_r[4:6]/wb$A_r[4]
wb$A_n[7:9]=wb$A_r[7:9]/wb$A_r[7]
wb$B_n[1:3]=wb$B_r[1:3]/wb$B_r[1]
wb$B_n[4:6]=wb$B_r[4:6]/wb$B_r[4]
wb$B_n[7:9]=wb$B_r[7:9]/wb$B_r[7]
wb$C_n[1:3]=wb$C_r[1:3]/wb$C_r[1]
wb$C_n[4:6]=wb$C_r[4:6]/wb$C_r[4]
wb$C_n[7:9]=wb$C_r[7:9]/wb$C_r[7]</code></pre>
</div>
<div id="首先需要把短数据转换为长数据把样本留下添加一列蛋白和一列灰度值分别命名为protein和value." class="section level4">
<h4>首先需要把短数据转换为长数据,把样本留下,添加一列蛋白和一列灰度值,分别命名为’protein’和’value’.</h4>
<pre class="r"><code>library(reshape2) 
wb_long&lt;-melt(wb,
                id.vars = c(&#39;sample&#39;),##需要保留的列,非数字格式
                measure.vars=c(&#39;A_n&#39;,&#39;B_n&#39;,&#39;C_n&#39;),##需要保留的值,数字格式
                variable.name=&#39;Protein&#39;,##新定义个列并命名,非数字格式
                value.name=&#39;Value&#39;)##新定义一个列并命名,数字格式</code></pre>
</div>
<div id="新增一个分组如果是单纯按ncoe和dr排序的话完全可以" class="section level4">
<h4>新增一个分组,如果是单纯按NC、OE、和DR排序的话,完全可以</h4>
<pre class="r"><code>wb_long$Group=rep(c(&#39;NC&#39;, &#39;OE&#39;,&#39;DR&#39;), each = 3)  ##分为3组，每组3个数据</code></pre>
</div>
<div id="但是这个数据是按nc1oe1dr1nc2这样排序所以上面代码分组后是错的最简单的办法是导出csv然后excel简单定义一下其实也就是把数字去掉加个group的组就行但是这部操作r我还没学会有个shiny的包可以交互式处理数据但是又不能直接保存到environment里其实这种简单的处理完全可以先excel处理好了以后再作图毕竟excel号称除了不能生孩子" class="section level4">
<h4>但是这个数据是按NC1,OE1,DR1,NC2…这样排序,所以上面代码分组后是错的,最简单的办法是导出csv,然后Excel简单定义一下,其实也就是把数字去掉,加个Group的组就行,但是这部操作R我还没学会,有个shiny的包可以交互式处理数据,但是又不能直接保存到Environment里,其实这种简单的处理,完全可以先excel处理好了以后再作图,毕竟<code>excel</code>号称除了不能生孩子…</h4>
</div>
<div id="当然如果你想用shiny可以按照dataeditr这个包直接安装即可但前提是要先安装好shiny" class="section level4">
<h4>当然如果你想用<code>shiny</code>,可以按照<code>DataEditR</code>这个包,直接安装即可,但前提是要先安装好shiny</h4>
<blockquote>
<p>instal.packages(“shiny”)
instal.packages(“DataEditR”)
library(DataEditR)
data_edit(wb_long)</p>
</blockquote>
<p>这样就可以像excel那样处理表格里,导出数据,再导入数据.</p>
<pre class="r"><code>wb_long&lt;-read.csv(&quot;/Users/mac/Documents/GitHub/blog/content/post/2021-08-11-使用r语言统计多蛋白多组的wb/wb_long.csv&quot;)</code></pre>
</div>
<div id="固定一下分组的顺序需要先设置为因子" class="section level2">
<h2>固定一下分组的顺序,需要先设置为因子</h2>
<pre class="r"><code>wb_long &lt;- within(wb_long, Group &lt;- factor(Group, levels = c(&quot;NC&quot;, &quot;OE&quot;,&quot;DR&quot;))) </code></pre>
</div>
<div id="画图这里联合ggplot2和ggpubr其实ggpubr可以一步出图但是底层限制死了我们可以借助ggppubr进行统计画图还是用ggplot2统计的是两种首先进行anova看整体差异然后看各组与对照组的差异" class="section level2">
<h2>画图,这里联合ggplot2和ggpubr,其实ggpubr可以一步出图,但是底层限制死了,我们可以借助ggppubr进行统计,画图还是用ggplot2,统计的是两种,首先进行anova看整体差异,然后看各组与对照组的差异</h2>
<pre class="r"><code>library(ggplot2)
library(ggpubr)
ggplot(wb_long ,
       aes(x=Group,y=Value,color=Group,fill=Group))+
    geom_bar(stat=&quot;summary&quot;,fun=mean,position=&quot;dodge&quot;)+
    stat_summary(fun.data = &#39;mean_sd&#39;, geom = &quot;errorbar&quot;, width = 0.5,position = position_dodge(0.9))+
    facet_grid(~Protein,scales = &#39;free&#39;)+
    theme_minimal(base_size = 12)+
    labs(x=NULL,y=&#39;Relative protein expression&#39;)+
    geom_dotplot(stackdir = &quot;center&quot;, binaxis = &quot;y&quot;, 
                 fill = &quot;lightgray&quot;, 
                 dotsize = 0.9,position = position_dodge(0.9))+
    stat_compare_means(method = &quot;anova&quot;)+
    stat_compare_means(method = &#39;t.test&#39;,label = &quot;p.signif&quot;,comparisons = list(c(&#39;NC&#39;,&#39;OE&#39;),c(&#39;NC&#39;,&#39;DR&#39;)))</code></pre>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/index.cn_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div id="也可以提取某一个蛋白的数据进行毕竟比如只看b蛋白的数据可以用下面的函数然后作图" class="section level4">
<h4>也可以提取某一个蛋白的数据,进行毕竟,比如只看<code>B蛋白</code>的数据,可以用下面的函数,然后作图</h4>
<pre class="r"><code>B&lt;-wb_long[wb_long$Protein == &#39;B_n&#39;,]
ggplot(B ,
       aes(x=Group,y=Value,color=Group,fill=Group))+
    geom_bar(stat=&quot;summary&quot;,fun=mean,position=&quot;dodge&quot;)+
    stat_summary(fun.data = &#39;mean_sd&#39;, geom = &quot;errorbar&quot;, width = 0.5,position = position_dodge(0.9))+
    theme_minimal(base_size = 12)+
    labs(x=NULL,y=&#39;Relative protein expression&#39;)+
    geom_dotplot(stackdir = &quot;center&quot;, binaxis = &quot;y&quot;, 
                 fill = &quot;lightgray&quot;, 
                 dotsize = 0.9,position = position_dodge(0.9))+
    stat_compare_means(method = &quot;anova&quot;)+
    stat_compare_means(method = &#39;t.test&#39;,label = &quot;p.signif&quot;,comparisons = list(c(&#39;NC&#39;,&#39;OE&#39;),c(&#39;NC&#39;,&#39;DR&#39;)))</code></pre>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/index.cn_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="当然也可以换个主题和配色可以用ggsci也可以用ggplot的自定义这里用ggsci的lancet配色" class="section level2">
<h2>当然也可以换个主题和配色,可以用<code>ggsci</code>,也可以用ggplot的自定义,这里用<code>ggsci</code>的<code>lancet</code>配色</h2>
<pre class="r"><code>library(ggsci)
ggplot(B ,
       aes(x=Group,y=Value,color=Group,fill=Group))+
    geom_bar(stat=&quot;summary&quot;,fun=mean,position=&quot;dodge&quot;)+
    stat_summary(fun.data = &#39;mean_sd&#39;, geom = &quot;errorbar&quot;, width = 0.5,position = position_dodge(0.9))+
    theme_bw(base_size = 12)+
    scale_color_lancet()+
    scale_fill_lancet()+
    labs(x=NULL,y=&#39;Relative protein expression&#39;)+
    geom_dotplot(stackdir = &quot;center&quot;, binaxis = &quot;y&quot;, 
                 fill = &quot;lightgray&quot;, 
                 dotsize = 0.9,position = position_dodge(0.9))+
    stat_compare_means(method = &quot;anova&quot;)+
    stat_compare_means(method = &#39;t.test&#39;,label = &quot;p.signif&quot;,comparisons = list(c(&#39;NC&#39;,&#39;OE&#39;),c(&#39;NC&#39;,&#39;DR&#39;)))</code></pre>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/index.cn_files/figure-html/unnamed-chunk-11-1.png" width="672" />
## 这里手动添加配色,然后把标签去掉,因为底下已经有标签了,加一句<code>theme(legend.position = 'none')</code></p>
<pre class="r"><code>ggplot(B ,
       aes(x=Group,y=Value,color=Group,fill=Group))+
    geom_bar(stat=&quot;summary&quot;,fun=mean,position=&quot;dodge&quot;)+
    stat_summary(fun.data = &#39;mean_sd&#39;, geom = &quot;errorbar&quot;, width = 0.5,position = position_dodge(0.9))+
    theme_bw(base_size = 12)+
    scale_color_manual(values = c(&#39;gray&#39;,&#39;steelblue&#39;,&#39;firebrick&#39;))+
    scale_fill_manual(values = c(&#39;gray&#39;,&#39;steelblue&#39;,&#39;firebrick&#39;))+
    labs(x=NULL,y=&#39;Relative protein expression&#39;)+
    geom_dotplot(stackdir = &quot;center&quot;, binaxis = &quot;y&quot;, 
                 fill = &quot;lightgray&quot;, 
                 dotsize = 0.9,position = position_dodge(0.9))+
    stat_compare_means(method = &quot;anova&quot;)+
    stat_compare_means(method = &#39;t.test&#39;,label = &quot;p.signif&quot;,comparisons = list(c(&#39;NC&#39;,&#39;OE&#39;),c(&#39;NC&#39;,&#39;DR&#39;)))+theme(legend.position = &#39;none&#39;)</code></pre>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/index.cn_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/plot/">plot</a>
  
  <a class="badge badge-light" href="/tag/r-markdown/">R Markdown</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/&amp;text=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/&amp;t=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae&amp;body=https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/&amp;title=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae%20https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://swcyo.netlify.app/post/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%9B%8B%E7%99%BD%E5%A4%9A%E7%BB%84%E7%9A%84wb%E6%95%B0%E6%8D%AE/&amp;title=%e4%bd%bf%e7%94%a8R%e8%af%ad%e8%a8%80%e7%bb%9f%e8%ae%a1%e5%a4%9a%e8%9b%8b%e7%99%bd%e5%a4%9a%e7%bb%84%e7%9a%84WB%e6%95%b0%e6%8d%ae" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://swcyo.netlify.app/"><img class="avatar mr-3 avatar-circle" src="/author/%E6%AC%A7%E9%98%B3%E6%9D%BE/avatar_hu32f889f3337c9db9518846833613667f_51454_270x270_fill_q75_lanczos_center.jpg" alt="欧阳松"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://swcyo.netlify.app/">欧阳松</a></h5>
      <h6 class="card-subtitle">主治医师、讲师</h6>
      <p class="card-text">My research interests include urogenital tumors, urolithiasis, male infertility, male erectile dysfunction,etc.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:ouyangsong87@gamil.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=eTN286IAAAAJ" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0001-7962-2811" target="_blank" rel="noopener">
        <i class="fab fa-orcid"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/swcyo" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/swcyoyond" >
        <i class="fab fa-weixin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://swcyo.gitee.io/cv" target="_blank" rel="noopener">
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/oncomine/">ROnmine处理oncomine数据</a></li>
      
      <li><a href="/post/torwilcoxon/">如何准确的使用R进行两独立样本的显著性检验，T检验？非参数检验？</a></li>
      
      <li><a href="/post/rstuido/">RStudio1.4发布，新增markdown可视化太强大了</a></li>
      
      <li><a href="/post/r-pcr/">R语言处理PCR数据，一步画柱状图、添加显著性标志并实现截断</a></li>
      
      <li><a href="/post/roc/">两独立样本进行统计,作箱式图和ROC曲线</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © {2021} Song Ou-Yang
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.d68ecd57c0ec1f1f61d65fd568f1c3a0.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
